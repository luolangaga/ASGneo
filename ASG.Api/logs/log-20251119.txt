2025-11-19 00:05:54.725 +08:00 [INF] Using URLs: http://localhost:5250
2025-11-19 00:05:54.786 +08:00 [INF] WebApplication built successfully.
2025-11-19 00:05:54.858 +08:00 [INF] SignalR hub mapped: Path=/hubs/app, AuthScheme=JWT Bearer, QueryToken=access_token for '/hubs/*'
2025-11-19 00:05:54.858 +08:00 [INF] CORS policy 'DevCors' applied: AllowAnyOrigin/AnyHeader/AnyMethod (Development)
2025-11-19 00:05:55.310 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-11-19 00:05:55.318 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-11-19 00:05:55.323 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-11-19 00:05:55.327 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-11-19 00:05:55.339 +08:00 [INF] User profile is available. Using 'C:\Users\luolan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-19 00:05:55.426 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Events" AS "e")
2025-11-19 00:05:55.429 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Teams" AS "t")
2025-11-19 00:05:55.432 +08:00 [INF] Starting Kestrel...
2025-11-19 00:05:55.475 +08:00 [INF] Database backup saved to /var/backups/asg\ASGApiDb_20251119_000555.db
2025-11-19 00:05:55.506 +08:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://127.0.0.1:5250: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: 通常每个套接字地址(协议/网络地址/端口)只允许使用一次。
 ---> System.Net.Sockets.SocketException (10048): 通常每个套接字地址(协议/网络地址/端口)只允许使用一次。
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-11-19 00:05:55.517 +08:00 [FTL] Host terminated unexpectedly during Kestrel startup
System.IO.IOException: Failed to bind to address http://127.0.0.1:5250: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: 通常每个套接字地址(协议/网络地址/端口)只允许使用一次。
 ---> System.Net.Sockets.SocketException (10048): 通常每个套接字地址(协议/网络地址/端口)只允许使用一次。
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.LocalhostListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.<Main>$(String[] args) in C:\Users\luolan\ASG\ASG.Api\Program.cs:line 370
2025-11-19 00:06:20.484 +08:00 [INF] Using URLs: http://localhost:5285
2025-11-19 00:06:20.542 +08:00 [INF] WebApplication built successfully.
2025-11-19 00:06:20.609 +08:00 [INF] SignalR hub mapped: Path=/hubs/app, AuthScheme=JWT Bearer, QueryToken=access_token for '/hubs/*'
2025-11-19 00:06:20.610 +08:00 [INF] CORS policy 'DevCors' applied: Restricted origins [https://idvevent.cn, https://admin.idvevent.cn, https://person.idvevent.cn]
2025-11-19 00:06:21.045 +08:00 [INF] Starting Kestrel...
2025-11-19 00:06:32.268 +08:00 [WRN] Failed to determine the https port for redirect.
2025-11-19 00:06:42.814 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:42.815 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:43.026 +08:00 [INF] Received HTTP response headers after 209.7852ms - 200
2025-11-19 00:06:43.029 +08:00 [INF] End processing HTTP request after 216.9776ms - 200
2025-11-19 00:06:44.860 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:44.861 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:44.968 +08:00 [INF] Received HTTP response headers after 107.3628ms - 200
2025-11-19 00:06:44.969 +08:00 [INF] End processing HTTP request after 108.5321ms - 200
2025-11-19 00:06:46.522 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:46.523 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:46.584 +08:00 [INF] Received HTTP response headers after 61.2742ms - 200
2025-11-19 00:06:46.585 +08:00 [INF] End processing HTTP request after 62.4013ms - 200
2025-11-19 00:06:48.503 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:48.503 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:48.561 +08:00 [INF] Received HTTP response headers after 57.1148ms - 200
2025-11-19 00:06:48.561 +08:00 [INF] End processing HTTP request after 58.4639ms - 200
2025-11-19 00:06:49.932 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:49.932 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:49.993 +08:00 [INF] Received HTTP response headers after 60.5257ms - 200
2025-11-19 00:06:49.993 +08:00 [INF] End processing HTTP request after 61.4908ms - 200
2025-11-19 00:06:51.545 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:51.546 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:06:51.602 +08:00 [INF] Received HTTP response headers after 56.0166ms - 200
2025-11-19 00:06:51.602 +08:00 [INF] End processing HTTP request after 57.2571ms - 200
2025-11-19 00:07:00.191 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:00.191 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:00.250 +08:00 [INF] Received HTTP response headers after 58.563ms - 200
2025-11-19 00:07:00.250 +08:00 [INF] End processing HTTP request after 59.4504ms - 200
2025-11-19 00:07:02.112 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:02.113 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:02.168 +08:00 [INF] Received HTTP response headers after 55.2461ms - 200
2025-11-19 00:07:02.168 +08:00 [INF] End processing HTTP request after 56.2826ms - 200
2025-11-19 00:07:04.191 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-19 00:07:04.208 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:04.208 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:04.283 +08:00 [INF] Received HTTP response headers after 75.0848ms - 200
2025-11-19 00:07:04.284 +08:00 [INF] End processing HTTP request after 76.1927ms - 200
2025-11-19 00:07:06.408 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:06.409 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:06.469 +08:00 [INF] Received HTTP response headers after 60.0934ms - 200
2025-11-19 00:07:06.470 +08:00 [INF] End processing HTTP request after 61.1331ms - 200
2025-11-19 00:07:19.606 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:19.606 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:19.690 +08:00 [INF] Received HTTP response headers after 83.475ms - 200
2025-11-19 00:07:19.691 +08:00 [INF] End processing HTTP request after 84.4544ms - 200
2025-11-19 00:07:22.578 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:22.578 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:22.643 +08:00 [INF] Received HTTP response headers after 64.249ms - 200
2025-11-19 00:07:22.643 +08:00 [INF] End processing HTTP request after 65.263ms - 200
2025-11-19 00:07:25.425 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:25.425 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:07:25.509 +08:00 [INF] Received HTTP response headers after 84.1761ms - 200
2025-11-19 00:07:25.510 +08:00 [INF] End processing HTTP request after 85.0573ms - 200
2025-11-19 00:16:02.960 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:16:02.961 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:16:03.112 +08:00 [INF] Received HTTP response headers after 150.6831ms - 200
2025-11-19 00:16:03.112 +08:00 [INF] End processing HTTP request after 151.4447ms - 200
2025-11-19 00:16:05.913 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:16:05.913 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:16:05.972 +08:00 [INF] Received HTTP response headers after 58.4387ms - 200
2025-11-19 00:16:05.973 +08:00 [INF] End processing HTTP request after 59.6249ms - 200
2025-11-19 00:16:09.410 +08:00 [INF] Start processing HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:16:09.411 +08:00 [INF] Sending HTTP request POST https://api.deepseek.com/chat/completions
2025-11-19 00:16:09.923 +08:00 [INF] Received HTTP response headers after 511.6821ms - 200
2025-11-19 00:16:09.923 +08:00 [INF] End processing HTTP request after 512.5099ms - 200
